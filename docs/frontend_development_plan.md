# 画像系统前端开发计划

## 一、概述

构建 Vue 3 前端展示客户画像数据，参考用户提供的设计图样式。

---

## 二、技术选型

| 组件 | 技术 | 说明 |
|------|------|------|
| 框架 | Vue 3 + TypeScript | 现代化前端框架 |
| 构建 | Vite | 快速开发服务器 |
| UI | Element Plus | 蓝色主题组件库 |
| 图表 | ECharts | 饼图 + 折线图 |
| HTTP | Fetch API | 原生 API 调用 |
| 部署 | Docker + Nginx | 容器化部署 |

---

## 三、目录结构

```
potrait/
├── src/                    # 后端代码
├── web/                    # 前端代码（独立目录）
│   ├── src/
│   │   ├── main.ts         # 入口文件
│   │   ├── App.vue         # 根组件
│   │   ├── views/          # 页面组件
│   │   │   └── PortraitDashboard.vue
│   │   ├── components/     # 通用组件
│   │   ├── api/            # API 调用
│   │   ├── styles/         # 样式文件
│   │   └── types/          # 类型定义
│   ├── Dockerfile
│   ├── nginx.conf
│   └── docker-compose.yml
└── docs/                   # 文档目录
```

---

## 四、页面布局设计

参考用户提供的设计图：

```
┌──────────────────────────────────────────────────────────────┐
│ 人群画像统计与分析                         🔍 搜索  📊 导出报告 │
├──────────────────────────────────────────────────────────────┤
│ [选择场景 ▼]  统计粒度: 按周 按月 按季  统计周期: [2025-W48 ▼] │
├─────────────────────────┬────────────────────────────────────┤
│     第一栏：统计信息     │         第二栏：趋势变化           │
│  ┌───────────────────┐  │  ┌──────────────────────────────┐ │
│  │   人群画像分布    │  │  │       画像趋势变化           │ │
│  │   [环形饼图]      │  │  │       [折线图]               │ │
│  │                   │  │  │  ━ 投诉风险 (红)             │ │
│  │   100%            │  │  │  ━ 流失风险 (橙)             │ │
│  │   总用户          │  │  │  ━ 满意用户 (绿)             │ │
│  │                   │  │  │                              │ │
│  │ ● 投诉风险 X%     │  │  └──────────────────────────────┘ │
│  │ ● 流失风险 X%     │  │                                    │
│  │ ● 满意用户 X%     │  │                                    │
│  └───────────────────┘  │                                    │
├─────────────────────────┴────────────────────────────────────┤
│                     用户画像明细列表                          │
│  ┌──────────────────────────────────────────────────────────┐│
│  │ 用户ID  手机号  所属场景  平均通话时长  满意度  风险  标签 ││
│  │ ...                                                      ││
│  └──────────────────────────────────────────────────────────┘│
│  显示 1 到 15 条，共 105 条                      < 1 2 3 4 > │
└──────────────────────────────────────────────────────────────┘
```

---

## 五、颜色主题（蓝色为主）

```css
:root {
  /* 主色蓝色体系 */
  --primary-color: #1677FF;
  --primary-light: #4096FF;
  --primary-dark: #0958D9;
  --primary-bg: #E6F4FF;
  
  /* 画像指标颜色 */
  --satisfied-color: #52C41A;   /* 满意用户 - 绿色 */
  --complaint-color: #FF4D4F;   /* 投诉风险 - 红色 */
  --churn-color: #FA8C16;       /* 流失风险 - 橙色 */
  
  /* 背景和文字 */
  --bg-color: #F5F7FA;
  --card-bg: #FFFFFF;
  --text-primary: #1F2329;
  --text-secondary: #646A73;
}
```

---

## 六、交互设计

### 6.1 场景视角交互流程

1. **选择场景** - 下拉选择任务/场景
2. **选择统计粒度** - 按周/月/季
3. **选择统计周期** - 最近的 N 个周期
4. **查看统计** - 饼图展示满意/投诉/流失占比
5. **查看趋势** - 折线图展示历史变化
6. **查看明细** - 表格展示单个客户详情

### 6.2 时间选择设计

```
统计粒度: [按周] [按月] [按季]     <-- 单选按钮组
统计周期: [2025-W48 ▼]            <-- 下拉框，显示最近周期
```

---

## 七、数据接口

### 已有 API

| API | 方法 | 说明 | 状态 |
|-----|------|------|------|
| `/api/v1/task` | GET | 任务列表 | ✅ |
| `/api/v1/task/{id}/summary` | GET | 任务汇总统计 | ✅ |
| `/api/v1/task/{id}/trend` | GET | 趋势数据 | ✅ |

### 待开发 API

| API | 方法 | 说明 |
|-----|------|------|
| `/api/v1/customer` | GET | 客户列表（分页） |
| `/api/v1/customer/{id}` | GET | 客户详情 |

---

## 八、开发步骤

### Phase 1: 项目初始化 ✅

- [x] 创建 Vue 3 + Vite 项目
- [x] 安装 Element Plus、ECharts
- [x] 配置 TypeScript 路径别名
- [x] 创建目录结构

### Phase 2: 样式和主题 ✅

- [x] 定义蓝色主题 CSS 变量
- [x] 创建通用样式类
- [x] 配置 Element Plus 主题色

### Phase 3: 页面组件 ⏳

- [x] 页面头部（标题、搜索、导出）
- [x] 筛选条（场景、粒度、周期选择）
- [ ] 饼图组件（人群分布）
- [ ] 折线图组件（趋势变化）
- [ ] 客户列表表格

### Phase 4: API 对接

- [ ] 任务列表加载
- [ ] 汇总数据加载
- [ ] 趋势数据加载
- [ ] 客户列表加载（Mock）

### Phase 5: Docker 部署

- [x] Dockerfile
- [x] nginx.conf
- [x] docker-compose.yml

---

## 九、运行方式

### 开发环境

```bash
# 启动后端
cd /Users/jia/Desktop/移动工作/remote_call/potrait
uv run uvicorn src.main:app --host 0.0.0.0 --port 8000

# 新终端启动前端
cd /Users/jia/Desktop/移动工作/remote_call/potrait/web
npm install
npm run dev
```

### Docker 部署

```bash
cd /Users/jia/Desktop/移动工作/remote_call/potrait/web
docker-compose up -d
```

---

## 十、验证清单

- [ ] 页面正常加载
- [ ] 场景选择器工作
- [ ] 周期选择器工作
- [ ] 饼图正确渲染
- [ ] 折线图正确渲染
- [ ] 表格数据展示
- [ ] 分页功能正常
- [ ] API 代理正确
